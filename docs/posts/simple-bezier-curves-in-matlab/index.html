<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Simple Bézier Curves in Matlab</title><link href="https://fonts.googleapis.com/css?family=Crimson+Pro:400,400i,700|Eczar:700|Source+Code+Pro:400,400i&display=swap" rel="stylesheet"><link href="/style.css" rel="stylesheet"> <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png"><link rel="manifest" href="/assets/site.webmanifest"><link rel="mask-icon" href="/assets/safari-pinned-tab.svg" color="#bf616a"><meta name="msapplication-TileColor" content="#bf616a"><meta name="theme-color" content="#bf616a"> <meta property="og:title" content="Simple Bézier Curves in Matlab"/><meta property="og:url" content="http://blog.hamaluik.ca/posts/simple-bezier-curves-in-matlab/"/><meta property="og:image" content="https://og-image.now.sh/Simple%20B%C3%A9zier%20Curves%20in%20Matlab.png?theme=light&md=0&fontSize=75px&images=https%3A%2F%2Fassets.zeit.co%2Fimage%2Fupload%2Ffront%2Fassets%2Fdesign%2Fhyper-color-logo.svg&widths=350&heights=350"/><meta property="og:description" content="&lt;p&gt;I’ve always been curious about how [Bézier] cubic splines are generated and I how I can use them in various projects (game development probably being the most immediately obvious). If you don’t know what I’m talking about, Wikipedia has a decent if somewhat tedious description. After digging through the math, I came up with these results which I’ll share for the simplicity of it all (they really are simpler than I ever though). I found most sources started at the beginning and gave huge mathematical backgrounds, which although are nice, are typically just not what I was looking for. What I was looking for (and what is presented here) is just the end result - given a set of input weights, how do I calculate the actual spline?&lt;&#x2F;p&gt; "/><meta property="og:type" content="article"/><meta property="og:locale" content="en_CA"/><meta property="og:site_name" content="Kenton Hamaluik"/><meta property="article:published_time" content=" 2013-11-17T22:59:00+00:00 "/><meta property="article:author" content="http://blog.hamaluik.ca/"/><meta property="article:tag" content="Math"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:image:alt" content="Simple Bézier Curves in Matlab"/></head><body><header><h1><a href="/">Kenton Hamaluik</a></h1></header><article><header><h1>Simple Bézier Curves in Matlab <time datetime='2013-11-17T22:59:00+00:00'>(2013-11-17)</time></h1></header><p>I’ve always been curious about how [Bézier] cubic splines are generated and I how I can use them in various projects (game development probably being the most immediately obvious). If you don’t know what I’m talking about, <a href="http://en.wikipedia.org/wiki/B%C3%A9zier_curve">Wikipedia</a> has a decent if somewhat tedious description. After digging through the math, I came up with these results which I’ll share for the simplicity of it all (they really are simpler than I ever though). I found most sources started at the beginning and gave huge mathematical backgrounds, which although are nice, are typically just not what I was looking for. What I was looking for (and what is presented here) is just the end result - given a set of input weights, how do I calculate the actual spline?</p><p>First things first, this is the kind of spline I’m talking about:</p><figure><img src="/images/cubic-splines-matlab/spline-segment.svg"><figcaption>A sample spline segment</figcaption></figure><p>Bézier splines are <strong>parametric</strong> curves, meaning instead of a function like:$$y(x) = …$$you instead get functions like:</p><p>$$\begin{aligned}x(t) &amp;= \ldots \\y(t) &amp;= \ldots\end{aligned}$$</p><p>Where \(t \in [0, 1]\). This isn’t a big deal though, and in fact makes our lives even easier - we can just create a list of points in between 0 and 1 and get the corresponding x, y, [and z] coordinates that belong there:</p><div class="highlight"><pre><span></span><span class="n">t</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</pre></div><p>The next thing we need to know is that $x(t)$ and $y(t)$ are just polynomials, defined as:</p><p>$$\begin{aligned}x(t) &amp;= At<sup>3 + Bt</sup>2 + Ct + D \\y(t) &amp;= Et<sup>3 + Ft</sup>2 + Gt + H\end{aligned}$$</p><p>Where \(A \ldots H\) are just coefficients. These coefficients can be calculated as such:</p><h1><a href="#-beginbmatrix-a--b--c--d-endbmatrix" aria-hidden="true" class="anchor" id="header-beginbmatrix-a--b--c--d-endbmatrix"></a>$$\begin{Bmatrix}A \\B \\C \\D\end{Bmatrix}</h1><p>\begin{bmatrix}-1 &amp; 3 &amp; -3 &amp; 1 \\3 &amp; -6 &amp; 3 &amp; 0 \\-3 &amp; 3 &amp; 0 &amp; 0 \\1 &amp; 0 &amp; 0 &amp; 0\end{bmatrix}\begin{Bmatrix}x_0 \\x_1 \\x_2 \\x_3\end{Bmatrix}$$</p><p>and:</p><h1><a href="#-beginbmatrix-e--f--g--h-endbmatrix" aria-hidden="true" class="anchor" id="header-beginbmatrix-e--f--g--h-endbmatrix"></a>$$\begin{Bmatrix}E \\F \\G \\H\end{Bmatrix}</h1><p>\begin{bmatrix}-1 &amp; 3 &amp; -3 &amp; 1 \\3 &amp; -6 &amp; 3 &amp; 0 \\-3 &amp; 3 &amp; 0 &amp; 0 \\1 &amp; 0 &amp; 0 &amp; 0\end{bmatrix}\begin{Bmatrix}y_0 \\y_1 \\y_2 \\y_3\end{Bmatrix}$$</p><p>Or, if you’re not big into matrices and vectors:</p><p>$$\begin{aligned}A &amp;= x_3 - 3 x_2 + 3 x_1 - x_0 \\B &amp;= 3 x_2 - 6 x_1 + 3 x_0 \\C &amp;= 3 x_1 - 3 x_0 \\D &amp;= x_0\end{aligned}$$</p><p>Note that the equations are essentially the same for each dimension, so $z$ would follow the exact same format (note how the $y$ coefficients are calculated the exact same way as the $x$ ones).</p><p>In order to construct this in Matlab, we could do something like the following:</p><div class="highlight"><pre><span></span><span class="n">x</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">;</span> <span class="mi">1</span><span class="p">;</span> <span class="o">-</span><span class="mi">1</span><span class="p">;</span> <span class="mi">0</span><span class="p">];</span>
<span class="n">y</span> <span class="p">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">;</span> <span class="mi">1</span><span class="p">;</span> <span class="mi">2</span><span class="p">;</span> <span class="mi">3</span><span class="p">];</span>
</pre></div><p>Such that we get points like:</p><figure><img src="/images/cubic-splines-matlab/points.png"><figcaption>The raw points we'll be using</figcaption></figure><p>We can then calculate coefficients as such:</p><div class="highlight"><pre><span></span><span class="n">C</span> <span class="p">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">;</span> <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">;</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">;</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>
<span class="n">Cx</span> <span class="p">=</span> <span class="n">C</span> <span class="o">*</span> <span class="n">x</span><span class="p">;</span> <span class="c">% Cx = [6; -9; 3; 0]</span>
<span class="n">Cy</span> <span class="p">=</span> <span class="n">C</span> <span class="o">*</span> <span class="n">y</span><span class="p">;</span> <span class="c">% Cy = [0; 0; 3; 0]</span>
</pre></div><p>Finally, to create the parametric curve we can combine everything:</p><div class="highlight"><pre><span></span><span class="n">sx</span> <span class="p">=</span> <span class="n">polyval</span><span class="p">(</span><span class="n">Cx</span><span class="p">,</span> <span class="n">t</span><span class="p">);</span>
<span class="n">sy</span> <span class="p">=</span> <span class="n">polyval</span><span class="p">(</span><span class="n">Cy</span><span class="p">,</span> <span class="n">t</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">);</span>
</pre></div><p>So that we get something like:</p><figure><img src="/images/cubic-splines-matlab/result.png"><figcaption>The cubic spline using the given raw points</figcaption></figure><p>Note that the “resolution” of this is entirely dependent on the number of points that exist in <code>t</code>. By default, in <code>linspace</code>, this will be 100, but we can easily drop that down:</p><div class="highlight"><pre><span></span><span class="n">t</span> <span class="p">=</span> <span class="nb">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
<span class="n">sx</span> <span class="p">=</span> <span class="n">polyval</span><span class="p">(</span><span class="n">Cx</span><span class="p">,</span> <span class="n">t</span><span class="p">);</span>
<span class="n">sy</span> <span class="p">=</span> <span class="n">polyval</span><span class="p">(</span><span class="n">Cy</span><span class="p">,</span> <span class="n">t</span><span class="p">);</span>
<span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">sy</span><span class="p">);</span>
</pre></div><p>Which results in:</p><figure><img src="/images/cubic-splines-matlab/lowres.png"><figcaption>We can reduce the resolution of the spline substantially and still get decent results</figcaption></figure><p>And we’re done! That was <strong>a lot</strong> easier than I was expecting!</p><p>Note that this formulation is just for <em>one</em> segment that would typically be part of a much longer line composed of multiple segments. If we wanted to connect two segments together, in order to make the connection smooth all we have to do is ensure the slope of these curves are equal. The easiest way to do this would most likely be to calculate \((x_1, y_1)\) in the second segment using \((x_2, y_2)\) and \((x_3, y_3)\) from the first segment such that:</p><p>$$\begin{aligned}x_0<sup>2 &amp;= x_3</sup>1 \\x_1<sup>2 &amp;= \left(x_3</sup>1 - x_2<sup>1\right) + x_3</sup>1 \\&amp;= 2x_3<sup>1 - x_2</sup>1 \\\end{aligned}$$</p><p>(Use the same formulation for the \(y\) dimension).</p><p>I’ll probably post more things later, such as how to calculate the length of each spline segment so that we can do things like determine appropriate $t$ resolutions and calculate total lengths of lines etc, but hopefully this will get you off to a start right now!</p></article><footer><span>© 2020 Kenton Hamaluik</span></footer></body></html>